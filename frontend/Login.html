<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hawassa Library | Login</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
     <style>
     
/* Login Page Specific Styles */
.login-body {
    background-color: #f8f9fa;
    font-family: 'Poppins', sans-serif;
}

.login-card {
    border-radius: 15px;
    overflow: hidden;
}

.bg-light-blue {
    background-color:   #f0f8ff;;
}

.min-vh-100 {
    min-height: 100vh;
}

.toggle-password {
    cursor: pointer;
}

.divider-text {
    background: white;
    padding: 0 10px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Close Button */
.btn-close-white {
    color: white;
    opacity: 0.8;
    transition: opacity 0.2s;
    background: none;
    border: none;
    font-size: 1.25rem;
}

.btn-close-white:hover {
    opacity: 1;
}

/* Dark Mode Support */
.dark-mode .login-body {
    background-color: #121212;
    color: #f8f9fa;
}

.dark-mode .login-card {
    background-color: #1e1e1e;
    color: #f8f9fa;
}

.dark-mode .divider-text {
    background: #1e1e1e;
}

.dark-mode .form-control, 
.dark-mode .input-group-text {
    background-color: #2d2d2d;
    border-color: #444;
    color: white;
}
  
  </style>
</head>
<body class="login-body">
    <!-- Main Login Container -->
    <div class="container">
        <div class="row justify-content-center align-items-center min-vh-100">
            <div class="col-lg-5 col-md-7">
                <!-- Login Card -->
                <div class="card login-card shadow-lg border-0">
                    <div class="card-header bg-light-blue text-white text-center py-4 border-0 position-relative">
                        <!-- Close Button -->
                        <button class="btn btn-close-primary position-absolute top-0 end-0 m-2" id="closeLogin">
                            <i class="fas fa-times"></i>
                        </button>
                        
                        <img src="images/logo1.png" alt="Library Logo" class="rounded-circle mb-3" style="width: 150px; height: 150px;">
                        <h3 class="text-dark">Welcome Back</h3>
                        <p class="mb-0 text-dark">Sign in to your Hawassa Library account</p>
                    </div>
                    <div class="card-body p-5">
                        <!-- Login Form -->
                        <form id="loginForm">
                            <div class="mb-4">
                                <label for="email" class="form-label">Email Address</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-envelope"></i>
                                    </span>
                                    <input type="email" class="form-control" id="email" placeholder="user@example.com" required>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label for="password" class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text ">
                                        <i class="fas fa-lock "></i>
                                    </span>
                                    <input type="password" class="form-control" id="password" placeholder="••••••••" required>
                                    <button class="btn btn-outline-secondary toggle-password" type="button">
                                        <i class="far fa-eye"></i>
                                    </button>
                                </div>
                                <div class="form-text text-end">
                                    <a href="#" class="text-decoration-none">Forgot password?</a>
                                </div>
                            </div>
                            
                            <div class="d-grid mb-3">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-sign-in-alt me-2"></i> Login
                                </button>
                            </div>
                            
                            <div class="text-center">
                                <p class="mb-0">Don't have an account? 
                                    <a href="Signup.html" class="text-primary text-decoration-none fw-bold">Sign up</a>
                                </p>
                            </div>
                        </form>
                        
                        <!-- Social Login Divider -->
                        <div class="position-relative my-4">
                            <hr>
                            <div class="divider-text position-absolute">OR</div>
                        </div>
                        
                        <!-- Social Login Options -->
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary">
                                <i class="fab fa-google me-2"></i> Continue with Google
                            </button>
                            <button class="btn btn-outline-primary">
                                <i class="fab fa-facebook-f me-2"></i> Continue with Facebook
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Security Notice -->
                <div class="text-center mt-4 small text-muted">
                    <i class="fas fa-shield-alt me-1"></i> Your data is securely encrypted
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Toggle Password Visibility
        document.querySelectorAll('.toggle-password').forEach(button => {
            button.addEventListener('click', function() {
                const passwordInput = this.previousElementSibling;
                const icon = this.querySelector('i');
                
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    icon.classList.replace('fa-eye', 'fa-eye-slash');
                } else {
                    passwordInput.type = "password";
                    icon.classList.replace('fa-eye-slash', 'fa-eye');
                }
            });
        });

        // Form Submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Login successful! Redirecting to dashboard...');
            window.location.href = "home.html";
        });

        // Close Button Functionality
        document.getElementById('closeLogin').addEventListener('click', function() {
            if(confirm('Are you sure you want to leave?')) {
                window.location.href = "home.html";
            }
        });

        // Dark Mode Toggle (if carrying over from other pages)
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }
    </script>

<script>
    const API_BASE = window.location.origin;

export const apiService = {
    async getBooks() {
        try {
            const response = await fetch(`${API_BASE}/api/books/`);
            if (!response.ok) throw new Error('Network response was not ok');
            return await response.json();
        } catch (error) {
            console.error('Failed to fetch books:', error);
            throw error;
        }
    },

    async borrowBook(bookId) {
        try {
            const response = await fetch(`${API_BASE}/api/books/${bookId}/borrow/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken'),
                },
                credentials: 'include'
            });
            return handleResponse(response);
        } catch (error) {
            console.error('Borrow failed:', error);
            throw error;
        }
    },

    // Add other API methods similarly
};

function handleResponse(response) {
    if (!response.ok) {
        return response.json().then(err => { throw err; });
    }
    return response.json();
}

function getCookie(name) {
    // Django CSRF token handling
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
</script>

</body>
</html>
